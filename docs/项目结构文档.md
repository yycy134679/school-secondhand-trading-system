# 校园二手交易推荐系统 - 项目结构文档

**版本**: 1.0  
**日期**: 2025-11-18

---

## 1. 项目根结构

```
school-secondhand-trading-system/
├── frontend/                 # 学生端前台应用（Vue3 + TypeScript）
├── admin-frontend/          # 管理员后台系统（Vue3 + TypeScript）
├── backend/                 # 后端服务（Go + Gin + PostgreSQL）
├── common/                  # 前后端共享的类型定义与常量
├── docs/                    # 项目文档目录
│   ├── PRD.md              # 产品需求文档
│   ├── 概要设计.md          # 架构设计文档
│   ├── 详细设计.md          # 详细设计文档
│   ├── 项目结构文档.md      # 本文档
│   ├── 开源项目参考.md      # 参考资料
├── sql/                     # 数据库脚本
│   └── schema.sql          # 数据库表结构定义
└── README.md               # 项目说明文档
```

---

## 2. 前端结构（frontend/）

学生端前台应用，采用 Vue3 + TypeScript + Vite + Pinia 技术栈。

```
frontend/
├── public/                          # 静态资源目录
│   └── favicon.ico                 # 网站图标
├── src/                            # 源代码目录
│   ├── api/                        # API 接口封装层
│   │   ├── index.ts               # API 基础配置（axios 实例、拦截器）
│   │   ├── user.ts                # 用户相关接口（注册、登录、个人信息）
│   │   ├── product.ts             # 商品相关接口（发布、编辑、详情、搜索）
│   │   ├── category.ts            # 分类接口（分类列表）
│   │   ├── tag.ts                 # 标签接口（标签列表）
│   │   ├── home.ts                # 首页接口（推荐 + 最新商品）
│   │   └── types.ts               # API 请求/响应类型定义
│   ├── assets/                     # 静态资源（图片、字体、样式）
│   │   ├── images/                # 图片资源
│   │   ├── styles/                # 全局样式文件
│   │   │   ├── reset.css         # CSS 重置样式
│   │   │   ├── common.scss       # 公共样式变量和 mixins
│   │   │   └── theme.scss        # 主题配置
│   │   └── fonts/                 # 字体文件
│   ├── components/                 # 可复用组件
│   │   ├── common/                # 通用组件
│   │   │   ├── AppHeader.vue     # 全局头部（导航栏、搜索框、用户信息）
│   │   │   ├── AppFooter.vue     # 全局底部
│   │   │   ├── Pagination.vue    # 分页组件
│   │   │   ├── Loading.vue       # 加载状态组件
│   │   │   ├── Empty.vue         # 空状态组件
│   │   │   └── Modal.vue         # 通用弹窗组件
│   │   ├── product/               # 商品相关组件
│   │   │   ├── ProductCard.vue   # 商品卡片（列表展示）；`mainImageUrl` 由后端响应提供（由 product_images 中 is_primary 标记的图片推导）
│   │   │   ├── ProductImageUpload.vue  # 图片上传组件
│   │   │   ├── ProductForm.vue   # 商品表单（发布/编辑复用）
│   │   │   ├── ProductStatus.vue # 商品状态标签
│   │   │   └── ProductFilter.vue # 商品筛选器（价格区间、排序）
│   │   └── user/                  # 用户相关组件
│   │       ├── LoginModal.vue    # 登录弹窗
│   │       ├── RegisterModal.vue # 注册弹窗
│   │       └── AvatarUpload.vue  # 头像上传组件
│   ├── router/                     # 路由配置
│   │   └── index.ts               # 路由定义与导航守卫
│   ├── store/                      # 状态管理（Pinia）
│   │   ├── index.ts               # Store 入口文件
│   │   ├── user.ts                # 用户状态（登录信息、token）
│   │   ├── product.ts             # 商品状态（列表缓存、筛选条件）
│   │   └── app.ts                 # 应用全局状态（加载状态、分类/标签数据）
│   ├── views/                      # 页面视图
│   │   ├── home/                  # 首页模块
│   │   │   └── Index.vue         # 首页（推荐商品 + 最新发布列表）
│   │   ├── product/               # 商品模块
│   │   │   ├── Detail.vue        # 商品详情页
│   │   │   ├── New.vue           # 发布商品页
│   │   │   ├── Edit.vue          # 编辑商品页
│   │   │   └── MyProducts.vue    # 我发布的商品列表
│   │   ├── search/                # 搜索模块
│   │   │   └── Index.vue         # 搜索结果页（关键词搜索 + 筛选排序）
│   │   ├── category/              # 分类模块
│   │   │   └── Index.vue         # 分类浏览页
│   │   └── user/                  # 用户模块
│   │       ├── Profile.vue       # 个人中心（查看/修改个人信息）
│   │       ├── Login.vue         # 登录页（备用，主要使用弹窗）
│   │       └── Register.vue      # 注册页（备用，主要使用弹窗）
│   ├── utils/                      # 工具函数
│   │   ├── request.ts             # Axios 请求封装与错误处理
│   │   ├── auth.ts                # 认证工具（token 存储、验证）
│   │   ├── format.ts              # 格式化工具（时间、价格、文件大小）
│   │   ├── validate.ts            # 表单验证规则
│   │   └── image.ts               # 图片处理（压缩、预览）
│   ├── App.vue                     # 根组件
│   ├── main.ts                     # 应用入口文件
│   └── env.d.ts                    # 环境变量类型声明
├── index.html                      # HTML 入口文件
├── vite.config.ts                  # Vite 构建配置
├── tsconfig.json                   # TypeScript 配置
├── package.json                    # 项目依赖配置
└── .env.development               # 开发环境变量配置
```

---

## 3. 管理后台结构（admin-frontend/）

管理员后台系统，采用 Vue3 + TypeScript + Vite + Pinia + Element Plus。

```
admin-frontend/
├── public/                          # 静态资源目录
│   └── favicon.ico                 # 网站图标
├── src/                            # 源代码目录
│   ├── api/                        # API 接口封装层
│   │   ├── index.ts               # API 基础配置（axios 实例、拦截器）
│   │   ├── admin.ts               # 管理员接口（仪表盘统计）
│   │   ├── user.ts                # 用户管理接口（列表、搜索）
│   │   ├── product.ts             # 商品管理接口（列表、查看）
│   │   ├── category.ts            # 分类管理接口（增删改查、引用检查）
│   │   ├── tag.ts                 # 标签管理接口（增删改查、引用检查）
│   │   └── types.ts               # API 请求/响应类型定义
│   ├── assets/                     # 静态资源
│   │   ├── images/                # 图片资源
│   │   └── styles/                # 样式文件
│   │       ├── reset.css         # CSS 重置
│   │       └── common.scss       # 公共样式
│   ├── components/                 # 可复用组件
│   │   ├── layout/                # 布局组件
│   │   │   ├── Sidebar.vue       # 侧边栏导航
│   │   │   ├── Header.vue        # 顶部栏（管理员信息、退出）
│   │   │   └── Breadcrumb.vue    # 面包屑导航
│   │   └── common/                # 通用组件
│   │       ├── SearchBar.vue     # 搜索栏
│   │       ├── DataTable.vue     # 数据表格（封装 Element Plus Table）
│   │       └── ConfirmDialog.vue # 确认对话框
│   ├── router/                     # 路由配置
│   │   └── index.ts               # 路由定义与权限守卫
│   ├── store/                      # 状态管理（Pinia）
│   │   ├── index.ts               # Store 入口
│   │   ├── admin.ts               # 管理员状态（登录信息、权限）
│   │   └── app.ts                 # 应用全局状态
│   ├── views/                      # 页面视图
│   │   ├── dashboard/             # 仪表盘模块
│   │   │   └── Index.vue         # 数据统计概览页
│   │   ├── user/                  # 用户管理模块
│   │   │   └── List.vue          # 用户列表页（搜索、查看）
│   │   ├── product/               # 商品管理模块
│   │   │   ├── List.vue          # 商品列表页（状态筛选、查看详情）
│   │   │   └── Detail.vue        # 商品详情页（只读）
│   │   ├── category/              # 分类管理模块
│   │   │   ├── List.vue          # 分类列表页
│   │   │   ├── Create.vue        # 新增分类页
│   │   │   └── Edit.vue          # 编辑分类页
│   │   ├── tag/                   # 标签管理模块
│   │   │   ├── List.vue          # 标签列表页
│   │   │   ├── Create.vue        # 新增标签页
│   │   │   └── Edit.vue          # 编辑标签页
│   │   └── login/                 # 登录模块
│   │       └── Index.vue         # 管理员登录页
│   ├── utils/                      # 工具函数
│   │   ├── request.ts             # Axios 请求封装
│   │   ├── auth.ts                # 认证工具（管理员 token）
│   │   ├── format.ts              # 格式化工具
│   │   └── validate.ts            # 表单验证规则
│   ├── App.vue                     # 根组件
│   ├── main.ts                     # 应用入口
│   └── env.d.ts                    # 环境变量类型声明
├── index.html                      # HTML 入口
├── vite.config.ts                  # Vite 配置
├── tsconfig.json                   # TypeScript 配置
├── package.json                    # 依赖配置
└── .env.development               # 开发环境变量
```

---

## 4. 后端结构（backend/）

后端服务，采用 Go + Gin + GORM + PostgreSQL，分层架构（Controller-Service-Repository）。

```
backend/
├── cmd/                            # 应用入口
│   └── main.go                    # 主函数（初始化服务、启动服务器）
├── config/                         # 配置管理
│   ├── config.go                  # 配置结构体定义与加载逻辑
│   ├── database.go                # 数据库连接配置
│   └── redis.go                   # Redis 连接配置
├── router/                         # 路由注册
│   ├── router.go                  # 路由总入口（注册所有模块路由）
│   ├── user.go                    # 用户模块路由
│   ├── product.go                 # 商品模块路由
│   ├── category.go                # 分类模块路由
│   ├── tag.go                     # 标签模块路由
│   ├── home.go                    # 首页/推荐模块路由
│   └── admin.go                   # 后台管理模块路由
├── middleware/                     # 中间件
│   ├── auth.go                    # 鉴权中间件（JWT 验证、用户身份注入）
│   ├── admin.go                   # 管理员权限中间件
│   ├── cors.go                    # 跨域配置中间件
│   ├── logger.go                  # 日志记录中间件
│   └── recovery.go                # 异常恢复中间件
├── controller/                     # 控制器层（HTTP 入口）
│   ├── user/                      # 用户控制器
│   │   └── controller.go         # 用户注册、登录、个人信息管理接口
│   ├── product/                   # 商品控制器
│   │   └── controller.go         # 商品发布、编辑、状态变更、详情、列表、搜索接口
│   ├── category/                  # 分类控制器
│   │   └── controller.go         # 分类列表、分类浏览接口
│   ├── tag/                       # 标签控制器
│   │   └── controller.go         # 标签列表接口
│   ├── recommend/                 # 推荐控制器
│   │   └── controller.go         # 首页数据接口（推荐 + 最新）
│   └── admin/                     # 后台管理控制器
│       ├── dashboard.go          # 仪表盘统计接口
│       ├── user.go               # 用户管理接口
│       ├── product.go            # 商品管理接口
│       ├── category.go           # 分类管理接口（增删改查）
│       └── tag.go                # 标签管理接口（增删改查）
├── service/                        # 服务层（业务逻辑）
│   ├── user/                      # 用户服务
│   │   └── service.go            # 注册、登录、个人信息更新、密码修改逻辑
│   ├── product/                   # 商品服务
│   │   └── service.go            # 商品发布、编辑、状态流转、撤销、详情、搜索逻辑
│   ├── category/                  # 分类服务
│   │   └── service.go            # 分类列表、新增、修改、删除（引用检查）逻辑
│   ├── tag/                       # 标签服务
│   │   └── service.go            # 标签列表、新增、修改、删除（引用检查）逻辑
│   ├── recommend/                 # 推荐服务
│   │   └── service.go            # 浏览记录、推荐计算、首页数据组装逻辑
│   └── admin/                     # 后台管理服务
│       └── service.go            # 仪表盘统计、用户/商品列表查询逻辑
├── repository/                     # 持久化层（数据访问）
│   ├── user_repo.go               # 用户数据访问接口与实现
│   ├── product_repo.go            # 商品数据访问接口与实现
│   ├── category_repo.go           # 分类数据访问接口与实现
│   ├── tag_repo.go                # 标签数据访问接口与实现
│   ├── view_record_repo.go        # 浏览记录数据访问接口与实现
│   └── db.go                      # 数据库连接池与事务管理
├── model/                          # 数据模型
│   ├── user.go                    # User 结构体（对应 users 表）
│   ├── product.go                 # Product、ProductImage 结构体（对应 products、product_images 表）
│   ├── category.go                # Category 结构体（对应 categories 表）
│   ├── tag.go                     # Tag、ProductTag 结构体（对应 tags、product_tags 表）
│   └── view_record.go             # UserRecentView 结构体（对应 user_recent_views 表）
├── common/                         # 公共模块
│   ├── resp/                      # 响应结构
│   │   ├── response.go           # 统一 JSON 响应结构（code、message、data）
│   │   └── dto.go                # 数据传输对象（DTO）定义（用户、商品、分类、标签）
│   ├── errors/                    # 错误码定义
│   │   └── codes.go              # 业务错误码常量（1001~5000）
│   ├── auth/                      # 认证工具
│   │   ├── jwt.go                # JWT 生成与验证
│   │   └── password.go           # 密码哈希与验证（bcrypt）
│   └── util/                      # 工具函数
│       ├── file.go               # 文件上传、图片处理
│       ├── validator.go          # 参数校验工具
│       └── cache.go              # Redis 缓存操作封装
├── go.mod                          # Go 模块依赖
├── go.sum                          # 依赖校验和
└── .env                            # 环境变量配置（数据库连接、Redis、JWT 密钥等）
```

---

## 5. Common 结构（common/）

前后端共享的类型定义与常量（TypeScript 与 Go 双向同步）。

```
common/
├── types/                          # 类型定义
│   ├── user.ts                    # 用户相关类型（前端）
│   ├── product.ts                 # 商品相关类型（前端）
│   ├── category.ts                # 分类类型（前端）
│   ├── tag.ts                     # 标签类型（前端）
│   └── response.ts                # 通用响应结构类型（前端）
├── constants/                      # 常量定义
│   ├── error_codes.ts             # 错误码常量（前端，对应后端 common/errors/codes.go）
│   ├── product_status.ts          # 商品状态常量（ForSale、Sold、Delisted）
│   └── product_condition.ts       # 新旧程度类型定义（Interface）。**注意：具体枚举值应在应用启动时通过 `GET /api/v1/product-conditions` 获取并存入 Pinia Store，前端不要硬编码具体值**。
└── README.md                       # Common 模块说明文档
```

**说明**：
- 此目录主要用于前端 TypeScript 类型定义，与后端保持结构一致性。
- 后端 Go 代码中的常量与类型在 `backend/common/` 和 `backend/model/` 中定义。
- 可通过脚本或工具保持前后端类型同步（如生成 TypeScript 类型定义）。

---

## 6. 模块职责说明

### 6.1 前端（frontend）职责

- **用户交互界面**：提供学生用户注册、登录、个人信息管理的界面。
- **商品浏览与搜索**：首页推荐、最新商品列表、关键词搜索、分类浏览、商品详情展示。
- **商品管理**：发布新商品、编辑商品、上下架操作、状态撤销、我发布的商品列表。
- **状态管理**：使用 Pinia 管理用户登录状态、商品列表缓存、分类标签数据。
- **路由与权限**：通过路由守卫保护需要登录的页面，未登录时跳转登录弹窗。

### 6.2 管理后台（admin-frontend）职责

- **数据统计**：仪表盘展示用户数、商品数、在售/已售商品统计。
- **用户管理**：查看用户列表、搜索用户。
- **商品管理**：查看商品列表、按状态筛选商品、查看商品详情。
- **分类与标签管理**：增删改查分类与标签，删除前检查引用计数。
- **权限控制**：所有接口需管理员权限，登录后验证 `isAdmin` 字段。

### 6.3 后端（backend）职责

- **API 提供**：为前端与管理后台提供 RESTful API。
- **业务逻辑**：实现商品状态机、推荐算法、分类/标签引用检查、权限验证等核心逻辑。
- **数据持久化**：通过 Repository 层封装对 PostgreSQL 的访问，支持事务管理。
- **缓存管理**：使用 Redis 缓存推荐结果、撤销状态记录、会话 token。
- **认证授权**：通过 JWT 实现无状态认证，鉴权中间件校验用户身份与管理员权限。
- **错误处理**：统一错误码与响应格式，提供友好的错误提示。

### 6.4 Common 职责

- **类型共享**：定义前后端共用的类型结构（如用户、商品、响应格式）。
- **常量共享**：定义错误码、商品状态、新旧程度等枚举常量。`product_condition.ts` 新旧程度常量以后端提供的 `product_conditions` 表/接口为准；前端常量仅作缓存及类型提示。
- **一致性保证**：通过脚本或工具保持前后端类型与常量的同步更新。




